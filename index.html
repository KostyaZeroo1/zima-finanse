<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Зима Финансы 2025</title>
    <style>
        *{margin:0;padding:0;box-sizing:border-box}
        body{font-family:Segoe UI,sans-serif;background:linear-gradient(135deg,#0f2027,#203a43,#2c5364);color:#e0f7fa;min-height:100vh;position:relative;overflow-x:hidden}
        .garland{position:fixed;top:0;left:0;width:100%;height:80px;pointer-events:none;z-index:999}
        .light{position:absolute;width:18px;height:18px;border-radius:50%;box-shadow:0 0 20px 4px currentColor;animation:blink 2.5s infinite}
        @keyframes blink{0%,100%{opacity:.4;transform:scale(.8)}50%{opacity:1;transform:scale(1.2)}}
        .snow{position:fixed;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:10}
        header{text-align:center;padding:90px 20px 20px;background:rgba(0,0,0,.4)}
        h1{font-size:3.5rem;text-shadow:0 0 30px #00ffff}
        nav{background:rgba(0,0,0,.5);padding:15px;position:sticky;top:0;z-index:30;text-align:center}
        nav a{color:#fff;text-decoration:none;margin:0 15px;padding:10px 20px;border-radius:10px}
        nav a:hover{background:#00ffff;color:#000}
        .container{max-width:1000px;margin:20px auto;padding:0 15px}
        .card{background:rgba(255,255,255,.1);backdrop-filter:blur(10px);border-radius:20px;padding:25px;margin:20px 0;box-shadow:0 10px 30px rgba(0,0,0,.5)}
        input,button{padding:14px;margin:8px 0;border:none;border-radius:12px;width:100%;font-size:1rem}
        input{background:rgba(255,255,255,.2);color:white}
        button{background:#00ffff;color:#000;font-weight:bold;cursor:pointer}
        button:hover{background:#00bfff}
        .progress-container{height:40px;background:rgba(0,0,0,.4);border-radius:20px;overflow:hidden;margin:20px 0}
        .progress{height:100%;width:0%;background:linear-gradient(90deg,#00ff80,#00ffff);transition:width 1s;display:flex;align-items:center;justify-content:center;color:#000;font-weight:bold}
        table{width:100%;border-collapse:collapse;margin-top:20px}
        th,td{padding:12px;text-align:left;border-bottom:1px solid rgba(255,255,255,.2)}
        th{background:rgba(0,255,255,.2)}
        .delete-btn{background:#ff0040;padding:6px 12px;border-radius:8px;cursor:pointer}
        .currency-btn{background:none;border:none;font-size:1.8rem;cursor:pointer;margin:0 10px}
        .music-btn{position:fixed;bottom:20px;right:20px;background:rgba(0,255,255,.3);width:60px;height:60px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:2rem;cursor:pointer;z-index:1000}
        .page{display:none}
        #home{display:block}
    </style>
</head>
<body>

<div class="garland" id="garland"></div>
<div class="snow"></div>

<header><h1>Мои Финансы 2025</h1></header>

<nav>
    <a onclick="showPage('home')">Главная</a>
    <a onclick="showPage('income')">Доходы</a>
    <a onclick="showPage('expense')">Расходы</a>
    <a onclick="showPage('goal')">Цель</a>
    <a onclick="showPage('stats')">Статистика</a>
</nav>

<div style="text-align:center;margin:20px">
    <button class="currency-btn" onclick="changeCurrency('₽')">₽</button>
    <button class="currency-btn" onclick="changeCurrency('$')">$</button>
    <button class="currency-btn" onclick="changeCurrency('€')">€</button>
</div>

<div class="container">
    <div id="home" class="page">
        <div class="card">
            <h2>Баланс</h2>
            <p style="font-size:2rem;text-align:center">Баланс: <b id="balance">0</b> <span class="currency">₽</span></p>
            <p style="font-size:1.5rem;text-align:center">Отложено: <b id="saved">0</b> <span class="currency">₽</span></p>
            <div class="progress-container"><div class="progress" id="mainProgress">0%</div></div>
        </div>
    </div>

    <div id="income" class="page">
        <div class="card">
            <h2>Добавить доход</h2>
            <input type="text" id="incomeDesc" placeholder="Откуда деньги?">
            <input type="number" id="incomeAmount" placeholder="Сумма">
            <button onclick="addIncome()">Добавить</button>
            <table id="incomeTable"><tr><th>Дата</th><th>Описание</th><th>Сумма</th><th></th></tr></table>
        </div>
    </div>

    <div id="expense" class="page">
        <div class="card">
            <h2>Добавить расход</h2>
            <input type="text" id="expenseDesc" placeholder="На что потратили?">
            <input type="number" id="expenseAmount" placeholder="Сумма">
            <button onclick="addExpense()">Добавить</button>
            <table id="expenseTable"><tr><th>Дата</th><th>Описание</th><th>Сумма</th><th></th></tr></table>
        </div>
    </div>

    <div id="goal" class="page">
        <div class="card">
            <h2>Финансовая цель</h2>
            <input type="text" id="goalName" placeholder="На что копим?">
            <input type="number" id="goalAmount" placeholder="Сколько нужно">
            <button onclick="setGoal()">Установить</button>
            <p style="font-size:1.5rem;margin:20px 0" id="goalText">Цель не установлена</p>
            <div class="progress-container"><div class="progress" id="goalProgress">0%</div></div>
            <button onclick="addToSavings()">Отложить с баланса</button>
            <input type="number" id="saveAmount" placeholder="Сколько отложить">
        </div>
    </div>

    <div id="stats" class="page">
        <div class="card">
            <h2>Статистика</h2>
            <p>Доходов: <b id="totalIncome">0</b> <span class="currency">₽</span></p>
            <p>Расходов: <b id="totalExpense">0</b> <span class="currency">₽</span></p>
            <p>Баланс: <b id="netBalance">0</b> <span class="currency">₽</span></p>
        </div>
    </div>
</div>

<div class="music-btn" onclick="toggleMusic()">Play Music</div>
<audio id="music" loop>
    <source src="https://cdn.pixabay.com/download/audio/2022/11/28/audio_5c7d7e9a1e.mp3" type="audio/mpeg">
</audio>

<script>
// Гирлянда
const colors=['#ff0000','#00ff00','#0000ff','#ffff00','#ff00ff','#00ffff'];
for(let i=0;i<Math.floor(innerWidth/40)+10;i++){
    const l=document.createElement('div');l.className='light';
    l.style.left=(i/(Math.floor(innerWidth/40)+9)*100)+'%';
    l.style.color=colors[i%colors.length];
    l.style.animationDelay=Math.random()*2+'s';
    document.getElementById('garland').appendChild(l);
}

// Снег
setInterval(()=>{const s=document.createElement('div');s.style.position='absolute';s.style.width=s.style.height=(Math.random()*5+3)+'px';
s.style.background='white';s.style.borderRadius='50%';s.style.opacity=Math.random()*0.6+0.4;
s.style.left=Math.random()*100+'vw';s.style.animation='fall '+(Math.random()*10+10)+'s linear';
document.querySelector('.snow').appendChild(s);setTimeout(()=>s.remove(),20000);},100);
document.head.appendChild(Object.assign(document.createElement('style'),{innerHTML:'@keyframes fall{to{transform:translateY(110vh) rotate(720deg)}}'}));

// Музыка
function toggleMusic(){
    const m=document.getElementById('music');
    m.paused?m.play():m.pause();
    document.querySelector('.music-btn').textContent = m.paused?'Play Music':'Stop Music';
}

// Валюта и числа
let currency=localStorage.getItem('cur')||'₽';
document.querySelectorAll('.currency').forEach(e=>e.textContent=currency);
function changeCurrency(c){currency=c;localStorage.setItem('cur',c);document.querySelectorAll('.currency').forEach(e=>e.textContent=c);updateAll();}
function f(n){return n.toString().replace(/\B(?=(\d{3})+(?!\d))/g,' ');}

// Данные и логика
let data=JSON.parse(localStorage.getItem('data')||'{"i":[],"e":[],"g":{"n":"","a":0},"s":0}');
function save(){localStorage.setItem('data',JSON.stringify(data));updateAll();}
function updateAll(){
    const ti=data.i.reduce((a,x)=>a+x.a,0), te=data.e.reduce((a,x)=>a+x.a,0), bal=ti-te;
    document.getElementById('balance').textContent=f(bal);
    document.getElementById('saved').textContent=f(data.s);
    document.getElementById('totalIncome').textContent=f(ti);
    document.getElementById('totalExpense').textContent=f(te);
    document.getElementById('netBalance').textContent=f(bal);
    const p=data.g.a>0?(data.s/data.g.a*100):0;
    document.getElementById('mainProgress').style.width=p+'%';document.getElementById('mainProgress').textContent=p.toFixed(0)+'%';
    document.getElementById('goalText').textContent=data.g.n?data.g.n+' — '+f(data.g.a)+' '+currency:'Цель не установлена';
    document.getElementById('goalProgress').style.width=p+'%';document.getElementById('goalProgress').textContent=p.toFixed(0)+'%';
    ['incomeTable','expenseTable'].forEach((id,isInc)=>{const t=document.getElementById(id);t.innerHTML='<tr><th>Дата</th><th>Описание</th><th>Сумма</th><th></th></tr>';
    (isInc?data.i:data.e).slice().reverse().forEach((x,j)=>{const r=t.insertRow();const real=j=(isInc?data.i:data.e).length-1-j;
    r.innerHTML=`<td>${new Date(x.d).toLocaleDateString()}</td><td>${x.t}</td><td>${isInc?'+':'-'}${f(x.a)}</td><td><button class="delete-btn" onclick="del(${isInc?'true':'false'},${real})">×</button></td>`;});});
}
function addIncome(){const desc=document.getElementById('incomeDesc');const am=document.getElementById('incomeAmount');if(!desc.value|| !am.value)return;data.i.push({t:desc.value,a:+am.value,d:Date.now()});desc.value='';am.value='';save();}
function addExpense(){const desc=document.getElementById('expenseDesc');const am=document.getElementById('expenseAmount');if(!desc.value|| !am.value)return;data.e.push({t:desc.value,a:+am.value,d:Date.now()});desc.value='';am.value='';save();}
function setGoal(){const n=document.getElementById('goalName').value;const a=document.getElementById('goalAmount').value;if(!n||!a)return;data.g={n:n,a:+a};save();}
function addToSavings(){const a=document.getElementById('saveAmount');if(!a.value)return;const bal=data.i.reduce((s,x)=>s+x.a,0)-data.e.reduce((s,x)=>s+x.a,0);if(bal<+a.value)return alert('Не хватает');data.s+=+a.value;a.value='';save();}
function del(isInc,idx){if(confirm('Удалить?')){(isInc?data.i:data.e).splice(idx,1);save();}}
function showPage(p){document.querySelectorAll('.page').forEach(x=>x.style.display='none');document.getElementById(p).style.display='block';}
updateAll();
</script>
</body>
</html>
